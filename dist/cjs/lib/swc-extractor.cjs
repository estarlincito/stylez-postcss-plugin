"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("node:fs/promises"),w=require("@swc/core"),A=require("fast-glob"),y=require("postcss"),v=require("./generate-id.cjs"),I=require("./sorted-rules.cjs"),{glob:O}=A,p=[],b=y.rule({selector:":root"});let m="stylez";async function q(g){const j=await O(g),u=new Set,n=new Set;for(const l of j){let i=function(e){if(!(!e||typeof e!="object")){if(e.type==="ImportDeclaration"&&e.source.value==="@stylezjs/stylez"&&Array.isArray(e.specifiers))for(const s of e.specifiers)(s.type==="ImportDefaultSpecifier"||s.type==="ImportNamespaceSpecifier")&&(m=s.local.value);if(e.type==="CallExpression"&&e.callee&&e.callee.type==="MemberExpression"&&e.callee.object&&e.callee.object.type==="Identifier"&&e.callee.object.value===m&&e.callee.property&&e.callee.property.type==="Identifier"&&e.callee.property.value==="create"){const r=e.arguments&&e.arguments[0];if(r&&r.expression.type==="ObjectExpression"){for(const t of r.expression.properties)if(t.type==="KeyValueProperty"&&t.key&&t.key.type==="Identifier"&&t.value&&t.value.type==="StringLiteral"||t.value.type==="NumericLiteral"){const a=v(t.value.value,"--z");u.has(a)||(u.add(a),b.append({prop:a,value:t.value.value}));const x=t.key.value.replace(/([A-Z])/g,o=>`-${o.toLowerCase()}`),c=v(JSON.stringify({[t.key.value]:t.value.value}),"z_");if(!n.has(c)){n.add(c);const o=y.rule({selector:`.${c}`});o.append({prop:x,value:`var(${a})`}),p.push(o)}}}}for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];Array.isArray(r)?r.forEach(i):r&&typeof r=="object"&&i(r)}}};const S=await h.readFile(l,"utf8"),k=w.parseSync(S,{syntax:"typescript",tsx:!0});i(k)}const f=y.root();return p.push(b),I(p).forEach(l=>f.append(l)),f}exports.extractStylesFromFiles=q;
